<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title> Datetime API test/input? </title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <style type="text/css">
    /* TODO(Christof): styling ??  */
    #result.error{
    	color:red;
    }
  </style>

  <meta name="theme-color" content="#fafafa">
</head>

<body>
	<label>
		Difference:
		<select id=diff>
			<option value="Days">Days</option>
			<option value="Weekdays">Weekdays</option>
			<option value="CompleteWeeks">Complete Weeks</option>
		</select>
	</label>
	<br>
	<br>
	<label>Date 1 <input id=date1 type=datetime-local></label>
	<label>TimeZone (empty for server default) <input id=tz1 type=text></label>
	<br>

	<br>


	
	<label>Date 2 <input id=date2 type=datetime-local> </label>
	<label>TimeZone (empty for server default) <input id=tz2 type=text> </label>
	<br>

	<br>
	<label><input type=checkbox id=convert> Convert to:</label>
	<select id=conversion>
		<option value="seconds">Seconds</option>
		<option value="minutes">minutes</option>
		<option value="hours">hours</option>
		<option value="years">years</option>
	</select>
	<br>
	<br>
	<button onclick="CallAPI(); return false;">API!</button>

	<fieldset>
		<legend>
			Result
		</legend>
		<div id=result>

		</div>
	</fieldset>
  <script>
    function CallAPI()
    {
    	//NOTE(Christof): because HTML5 spec (or more accurately existing browser behaviour *NOW* defined to be the HTML5 spec), we can now rely on ID'd elements existing on both document and window and since in this context the global is also window, we can just use the IDs as variables. Isn't that fun!
    	let url = `api.php?operation=${diff.value}&date1=${date1.value}&date2=${date2.value}`;

    	if(convert.checked)
    	{
    		url += `&convert=${conversion.value}`
    	}

    	if(tz1.value)
    	{
    		url += `&timezone1=${tz1.value}`
    	}


    	if(tz2.value)
    	{
    		url += `&timezone2=${tz2.value}`
    	}

    	let ok = true;
    	fetch(url).then(response => {
    			ok = response.ok;
    			return response.text();
    		}
    		).then(data => {
	    		result.innerText = data
	    		result.className = ok?"":"error";
	    	})
    }
  </script>


</body>

</html>
